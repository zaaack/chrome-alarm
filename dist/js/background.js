!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=38)}({1:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return u})),n.d(e,"d",(function(){return l}));var r,o=function(){function t(){}return t.prototype.get=function(t,e){var n=localStorage.getItem(t);return n?JSON.parse(n):null!=e?e:null},t.prototype.set=function(t,e){localStorage.setItem(t,JSON.stringify(e))},t.prototype.delete=function(t){localStorage.removeItem(t)},t}(),i=function(){function t(t,e,n){this._kv=t,this._key=e,this._defaults=n}return t.prototype.get=function(t){return void 0===t&&(t=this._defaults),this._kv.get(this._key,t)},t.prototype.set=function(t){return this._kv.set(this._key,t)},t.prototype.delete=function(){return this._kv.delete(this._key)},t}();!function(t){t.once="once",t.repeat="repeat"}(r||(r={}));var u,a={M1:6e4,H1:36e5};!function(t){t.empty=function(){return{ahead:0,type:r.repeat,duration:a.H1,timeout:Date.now()+a.H1,title:"New Alarm",id:Math.random().toString(36).slice(2)}}}(u||(u={}));var l=new(function(){function t(){this._kv=new o,this.alarms=new i(this._kv,"alarms")}return t.prototype.getAll=function(){return this.alarms.get([])},t.prototype.get=function(t){return console.log("id",t,this.getAll()),this.getAll().find((function(e){return e.id===t}))},t.prototype.saveAll=function(t){this.alarms.set(t)},t.prototype.remove=function(t){var e=this.getAll().filter((function(e){return e.id!==t.id}));this.saveAll(e)},t.prototype.save=function(t){var e=this.getAll(),n=e.findIndex((function(e){return e.id===t.id}));n<0&&(n=e.length),e[n]=t,this.saveAll(e)},t}())},2:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o}));var r=function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function o(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n}},38:function(t,e,n){"use strict";n.r(e),n.d(e,"AlarmManager",(function(){return i}));var r=n(2),o=n(1),i=function(){function t(){this.timers=new Map,this.updateTimers()}return Object.defineProperty(t.prototype,"alarms",{get:function(){return o.d.getAll()},enumerable:!0,configurable:!0}),t.prototype.save=function(t){o.d.save(t),this.updateTimers()},t.prototype.saveAll=function(t){o.d.saveAll(t),this.updateTimers()},t.prototype.remove=function(t){o.d.remove(t),this.clearTimers(t)},t.prototype.notify=function(t){new Notification(t.title+" | 整点报时",{body:(new Date).toLocaleString(),vibrate:1,requireInteraction:!0}),console.log("notify",(new Date).toLocaleString(),t)},t.prototype.clearTimers=function(t){for(var e=0,n=this.timers.get(t.id)||[];e<n.length;e++){var r=n[e];clearTimeout(r),clearInterval(r)}this.timers.delete(t.id)},t.prototype.updateTimers=function(){for(var t=this,e=function(e){if(e.disabled||e.done)return n.clearTimers(e),"continue";var i=n.timers.get(e.id);if(!i){i=[],console.log("updateTimers",e);var u=Date.now();if(e.type===o.b.once){var a=setTimeout((function(){t.notify(e),t.save(Object(r.a)(Object(r.a)({},e),{done:!0}))}),e.timeout-(u+e.ahead*o.c.M1));i.push(a)}else if(e.type===o.b.repeat){var l=function(){var n=e.duration-(Date.now()+e.ahead*o.c.M1)%e.duration,r=setTimeout((function(){t.notify(e),l()}),n);i[0]=r,console.log("next repeat "+e.title,new Date(Date.now()+n).toLocaleString(),e)};l()}n.timers.set(e.id,i)}},n=this,i=0,u=this.alarms;i<u.length;i++){e(u[i])}},t}();window.alarmManager=new i}});